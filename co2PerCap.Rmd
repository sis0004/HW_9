
---
title: "HW_9 CO2"
author: "Sara & Luis Andr√©s"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Please install and load these packages to get this .Rmd to render figures:
```{r, libraries}
library(markdown)
library(knitr)
library(kableExtra)
```

For this assignment, we use the file _data/co2_emissions_tonnes_per_person_gapminder.csv_

***
### Questions:

1. Are the data in a flat file format? 

Yes, the data is in CSV format which is a flat file format. 

```{r, echo =FALSE}
co2perCap<-read.csv("data/co2_emissions_tonnes_per_person_gapminder.csv")

```

2. What is the structure of the data?  Are there any variables you might need to convert prior to manipulating the data?

The data is structured as a "`r class(co2perCap)`", with contries as levels (`r nrow(co2perCap)`) and years (`r ncol(co2perCap)`) as variables. We did not need to convert any variables. 

3. What countries had per capita emissions larger than the 95th percentile in 2014? Make a table of their names and per capita emissions. 

We used quantile() function to find the 95% cutoff. See the answers in the table below:
```{r,echo=FALSE}
dat <- co2perCap$X2014>quantile(co2perCap$X2014,0.95) #countries that are in the top 5% of CO2 producers per capita in 2014
table <- data.frame("Country"=co2perCap$country[dat], "PerCapEmissions.2014"=co2perCap$X2014[dat]) #table containing top 5% of CO2 producers per capita and amount of CO2 produced in 2014 (units in tons)
table %>%
  kable() %>%
  kable_styling()
```

4. Make a table comparing the per capita emissions of the US and the world's highest per capita emitter (from above)  in 1925, 1950, and 2014.  

```{r, echo=FALSE}
max <- which.max(co2perCap$X2014) #gives the factor of the highest emitting country in 2014
TopCountry <- as.character(co2perCap$country[max]) #converts factor to character
```
The largest emiter per capita was `r TopCountry`. Their emission have been higher than the US only in 2014. Results are shown in the following table. 

```{r, echo=FALSE}
countries <- co2perCap[co2perCap$country %in% c("United States", "Qatar"), ]#index United States and Qatar
fdata <- countries[ , c("X2014", "X1950", "X1925")]
ex_tab <- data.frame(fdata)
colnames(ex_tab) <- c("2014", "1950", "1925")
row.names(ex_tab) <- c("Qatar", "United States")
ex_tab %>%
  kable() %>%
  kable_styling()
```
